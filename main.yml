---
- hosts: all
  gather_facts: yes

  vars_files:
    - vars/default.config.yml

  pre_tasks:
    - name: Include playbook configuration
      include_vars: "{{ item }}"
      with_fileglob:
        - "{{ playbook_dir }}/config.yml"

    - name: Run distro specific pre-tasks
      include_tasks: "tasks/setup_pre_tasks/{{ ansible_distribution | lower }}.yml"

  roles:
    - role: geerlingguy.ruby
      become: yes
    - role: geerlingguy.go
      become: yes
    - role: darkwizard242.onepassword
      become: yes
    - role: geerlingguy.ansible
      become: yes

  tasks:
    - name: Ensure common terminal tools are present
      become: yes
      package:
        name: "{{ common_term_tools }}"
        state: present

    - name: Install package managers
      import_tasks: tasks/package_manager/main.yml

    - name: Install general use software (browsers, office, etc)
      import_tasks: tasks/gen/main.yml

    - name: Install programming languages
      include_tasks: tasks/lang/main.yml

    - name: Install dev tools
      include_tasks: tasks/dev_tools/main.yml
